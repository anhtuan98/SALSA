<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Salsa Deployment Engine</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="scripts/jquery-1.3.2.debug.js" type="text/javascript"></script>
<script src="scripts/json.debug.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<link href="default.css" rel="stylesheet" type="text/css" />

<script> 
    $(function(){
      $("#deploymentInfo").load("ServiceRuntime.html"); 
    });
</script>

</head>
<body>


<script type="text/javascript">

window.onerror=function(msg, url, linenumber){
 alert('Error message: '+msg+'\nURL: '+url+'\nLine Number: '+linenumber)
 return true
}
</script>


<h3>New deployment</h3>
<form id="inputForm" action='rest/deploy' method='post' enctype="multipart/form-data" target="upload_target">
	Tosca file: <input type='file' name='file' id='file'>
	<br/>
	Service name:<input type='text' name='serviceName' id='serviceName'> 
	<br/>		
 	<input id="deployBtn" type="submit" onclick="waitForDeploy()" value="Deploy !"> 
 	<div id="waittext"></div>
<!-- 	<button name="deployBtn" id="deployBtn" onclick="clickDeploy()">Deploy jquery !</button> -->
</form>

<iframe id="upload_target" name="upload_target" style="width:0;height:0;border:1px solid #fff;"></iframe>

<hr />
<h3>Deployment information</h3>


 <script type="text/javascript">
 var str="Registering new service.";
 function waitForDeploy()
 {
	var mybody=document.getElementById('upload_target').contentWindow.document.body.innerHTML;
	if (!mybody.length){
		$("#deployBtn").hide();
		setTimeout(waitForDeploy, 1000);
		str=str.concat(".");
		$("#waittext").text(str).fadeIn();
		//alert("wait !: **" + mybody + "**");
	} else {
		$.getJSON(listSource,  function(json){ 
	  		$('#list').html(createListTable(json.services)).fadeIn();
	  	});
		$("#deployBtn").show();
		$("#waittext").html('');
	}
 }
 
    </script>



<div id="deploymentInfo"></div>






</body>
</html>