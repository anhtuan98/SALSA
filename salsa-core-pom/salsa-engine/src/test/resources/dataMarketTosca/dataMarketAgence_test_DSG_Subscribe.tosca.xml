<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<tosca:Definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:elasticity="http://www.example.org/NewXMLSchema" 
	xmlns:tosca="http://docs.oasis-open.org/tosca/ns/2011/12"
	xmlns:salsa="http://example.com"
	xsi:schemaLocation="http://docs.oasis-open.org/tosca/ns/2011/12 TOSCA-v1.0.xsd"
	targetNamespace="http://tempuri.org"
	id="DaaSApp">
	
	<tosca:ServiceTemplate id="DataMarketAgence">
		<tosca:TopologyTemplate>
			<tosca:NodeTemplate id="agence"
				name="agence" type="software"
				minInstances="50" maxInstances="200">				
				<tosca:Properties>
					<MappingProperties>
						<MappingProperty type="env">
							<property name="databusIp">10.99.0.14</property>
							<property name="method">subscribe</property>
						</MappingProperty>
						<ElasticityRequirement name="deploymentAgence">
							<property name="resource">compute</property>
							<property name="boundary">10</property>
							<property name="reaction">5</property>
							<property name="resize">horizontal</property>							
						</ElasticityRequirement>
					</MappingProperties>
				</tosca:Properties>
							
				<tosca:DeploymentArtifacts>
					<tosca:DeploymentArtifact artifactType="sh" name="Deployment script" artifactRef="deployAgenceScript"/>
				</tosca:DeploymentArtifacts>
			</tosca:NodeTemplate>
			
			<tosca:NodeTemplate id="agence_os"
				name="agence os" type="os"
				minInstances="1" maxInstances="3">
				<tosca:Properties>
					<MappingProperties>		
						<MappingProperty type="os">
							<property name="instanceType">m1.small</property>
							<property name="provider">dsg@openstack</property> <!-- lal@stratuslab / dsg@openstack -->
							<property name="baseImage">ami-00000163</property> <!-- KBhcU87Wm5IZNOXZYGHrczGekwp / ami-00000163 -->
							<property name="packages">openjdk-7-jre</property> <!-- use comma between package -->
						</MappingProperty>
					</MappingProperties>
				</tosca:Properties>
				<tosca:Requirements>
					<tosca:Requirement name="databus ip" type="String" id="databusIp"></tosca:Requirement>
				</tosca:Requirements>
				<tosca:DeploymentArtifacts>
					<tosca:DeploymentArtifact artifactType="tosca:script" name="Deployment script" artifactRef="deployDataController"/>
				</tosca:DeploymentArtifacts>
			</tosca:NodeTemplate>
			<tosca:RelationshipTemplate type="HOSTON" id="angen_on_od">
				<tosca:SourceElement ref="agence"/>
				<tosca:TargetElement ref="agence_os"/>
			</tosca:RelationshipTemplate>
		</tosca:TopologyTemplate>
		
		
	</tosca:ServiceTemplate>
	
	<tosca:NodeType name="software">
		<tosca:Interfaces>
			<tosca:Interface name="reconfigure">
				<tosca:Operation name="reconfigure"></tosca:Operation>
				<tosca:Operation name="start"></tosca:Operation>
				<tosca:Operation name="stop"></tosca:Operation>
				<tosca:Operation name="status"></tosca:Operation>
			</tosca:Interface>
		</tosca:Interfaces>
	</tosca:NodeType>
	
	<tosca:NodeTypeImplementation nodeType="software" name="softwareimpl">
		<tosca:ImplementationArtifacts>
			<tosca:ImplementationArtifact artifactType="sh">
				
			</tosca:ImplementationArtifact>
		</tosca:ImplementationArtifacts>
		<tosca:DeploymentArtifacts>
			<tosca:DeploymentArtifact name="" artifactType=""></tosca:DeploymentArtifact>
		</tosca:DeploymentArtifacts>
	</tosca:NodeTypeImplementation>

	<tosca:ArtifactTemplate id="deployAgenceScript" type="sh">		
		<tosca:ArtifactReferences>
			<tosca:ArtifactReference
				reference="http://134.158.75.65/salsa/upload/files/datamarket/dataMarketAgence_dsg_subscribe.sh" />				
		</tosca:ArtifactReferences>
	</tosca:ArtifactTemplate>
	
</tosca:Definitions>